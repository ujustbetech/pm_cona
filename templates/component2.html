{% extends "base.html" %}
{% block content %}
<style>
  /* Default */

.table-wrapper td,
.table-wrapper th {
    text-align: left;
}

/* Right-align numeric columns */
.table-wrapper td[data-col="On Hand"],
.table-wrapper td[data-col="Stock Value"],
.table-wrapper td[data-col="Days Dormant"] {
    text-align: right;
}

.card-container {
    background: white;
    padding: 30px;
    border-radius: 20px;
    display: grid;
    grid-template-columns: 1.2fr 1fr;
    gap: 40px;
    align-items: start;
    margin-bottom: 40px;
}

.card-text h2, 
.card-text h3, 
.card-text p {
    color: #1e1e1e; /* black text */
    margin-bottom: 12px;
}
</style>

<h2 style="color: white;">KPI Name: {{ label }} (Data Period :Sept-Nov'25)</h2>
<h3 style="color: white;">Alignment of KPI with Business Objective: Increase Warehouses & Reduce SCM TAT to 2-4 days (PAN India)</h3>

<!-- <h4>Inventory & Supply Chain Management</h4> -->

<!-- <hr> -->

<!-- KPI SUMMARY -->
<!-- <div class="kpi-container">
  {% for key, value in summary.items() %}
    <div class="kpi-card">
      <div class="kpi-value">{{ value }}</div>
      <div class="kpi-label">
        {{ key.replace('_',' ').title() }}
      </div>
    </div>
  {% endfor %}
</div>

<hr> -->
<!-- KPI SUMMARY CARDS -->
<!-- <div style="
    display: grid;
    grid-template-columns: repeat(3, 1fr);
    gap: 24px;
    margin: 30px 0 40px 0;
">

    <div class="card-container" style="grid-template-columns: 1fr;">
        <div class="card-text">
            <h3>Total Stock Qty</h3>
            <h2>{{ summary['Total Stock Qty'] | default(0) }}</h2>
        </div>
    </div>

    <div class="card-container" style="grid-template-columns: 1fr;">
        <div class="card-text">
            <h3>Slow-Moving Stock Qty</h3>
            <h2>{{ summary['Slow-Moving Stock Qty'] | default(0) }}</h2>
        </div>
    </div>

    <div class="card-container" style="grid-template-columns: 1fr;">
        <div class="card-text">
            <h3>Dead Stock Qty</h3>
            <h2>{{ summary['Dead Stock Qty'] | default(0) }}</h2>
        </div>
    </div>

</div> -->

<!-- CHARTS -->
{% if charts %}
  <div class="chart-grid">

    {% if charts.chart_0 %}
<div class="chart-card">


  <!-- Actual chart -->
  {{ charts.chart_0 | safe }}
  


  <!-- Subtitle / KPI context -->
<!-- <div style="font-size: 15px; color: #374151; margin-top: 10px;">
  <strong>Total Inventory:</strong> {{ summary["Total Stock Qty Fmt"] }} |
  <span style="color:#1d4ed8;">
    <strong>Slow-Moving:</strong>
    {{ summary["Slow-Moving Stock Qty Fmt"] }}
    ({{ summary["Slow-Moving %"] }})
  </span> |
  <span style="color:#b91c1c;">
    <strong>Dead Stock:</strong>
    {{ summary["Dead Stock Qty Fmt"] }}
    ({{ summary["Dead %"] }})
  </span>
</div> -->



</div>

    {% endif %}

    {% if charts.chart_1 %}
      <div class="chart-card">
        <h3>Inventory Quantity by Category</h3>
        {{ charts.chart_1 | safe }}
      </div>
    {% endif %}

  </div>
{% endif %}
 <h2 style="color: white;">Observation: Since the data is from the period Sept-Nov'25, Dead Stock information not available. All the items are of slow-moving status. <br> Note: Dead Stocks - Items that have not been moved for more than 365 days. <br>We have considered different categories of slow moving uom, we observe that UOM of items of type PCS has the highest slow-moving value(39.92 Cr), of type KGS has the second highest slow-moving value(6.4 Cr), of type GRS has slow-moving value of 2.04 cr. of type Roll has slow-moving value of 35 lakhs and of type SQF has slow-moving value of 22.9 Lakhs.</h2>
<div style="
    display: flex;
    justify-content: space-between;
    align-items: center;
    margin-top: 20px;
">

    <h2 style="color:white; margin: 0;">KPI data in Table</h2>

    <div>
        <a href="javascript:history.back()" 
           style="
               background:#ffffff;
               color:#003d99;
               padding:8px 16px;
               border-radius:8px;
               font-weight:600;
               text-decoration:none;
               margin-right:10px;
               box-shadow:0 2px 5px rgba(0,0,0,0.15);
           ">
           ← Back
        </a>

        <a href="/download/{{ kpi_id }}" 
           style="
               background:#ffffff;
               color:#003d99;
               padding:8px 16px;
               border-radius:8px;
               font-weight:600;
               text-decoration:none;
               box-shadow:0 2px 5px rgba(0,0,0,0.15);
           ">
            ⬇ Download Excel
        </a>
    </div>

</div>
<hr>

<!-- TABLE -->
{% if table_html %}
  <div class="table-wrapper">
    {{ table_html | safe | replace('On_Hand', 'On Hand') | replace('Stock_Value', 'Stock Value') }}
  </div>
{% endif %}
<script>
document.querySelectorAll(".table-wrapper tbody tr").forEach(row => {
    const text = row.innerText;
    if (text.includes("NaN") || text.includes("<NA>")) {
        row.style.display = "none";
    }
});
</script>
<a href="/departments">⬅ Back to Departments</a>


{% endblock %}


